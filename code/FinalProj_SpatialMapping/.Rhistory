P4 <- chehalisFiltered%>%
ggplot(aes(x=Score*0.8))+
geom_rect(aes(xmin = 40.67*0.8, xmax = 52*0.8, ymin = 0, ymax = 150), fill = "pink1",alpha = 0.1)+
geom_histogram(bins=100)+
theme_classic()+
theme(plot.title = element_text(size = 11),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())+
scale_x_continuous(expand = c(0,0),
limits = c(0,100))+
scale_y_continuous(expand= c(0,0),
breaks = c(50, 100, 150))+
xlab(element_blank())+
ylab(element_blank())+
geom_vline(xintercept=46.9*0.8, color = "red")+
geom_vline(xintercept = 46.3*0.8, linetype = "dashed", color = "red")+
ggtitle("Chehalis")+
annotate(geom = "text", y = 100, x = 80, label = "n = 1946", size=3.5)+
annotate(geom = "text", y = 75, x = 80, label = "skew = 0.708", size=3.5)
#Import Data
Thurston <- read_excel(here("data/Thurston/Fixed Thurston County FP Potential Project List.xlsx"))
#Filtering out non-barriers
Thurston %>%
filter(TotalScore > 0)->
ThurstonF
#Summary Stats, n = 297
mean(ThurstonF$TotalScore) #20.6
median(ThurstonF$TotalScore) #12
range(ThurstonF$TotalScore) #1, 86
sd(ThurstonF$TotalScore) #18.9
IQR(ThurstonF$TotalScore)
quantile(ThurstonF$TotalScore)
#0%  25%  50%  75% 100%
#1    5   12   34   86
skewness(ThurstonF$TotalScore) #1.02
#Test for normal distribution
shapiro.test(ThurstonF$TotalScore) #p<3.4e-16
#Plot Hist
#Multiplied by 1.05 to normalize to 100
P5 <- ThurstonF%>%
ggplot(aes(x=TotalScore*1.05))+
geom_rect(aes(xmin = 5*1.05, xmax = 34*1.05, ymin = 0, ymax = 50), fill = "pink1",alpha = 0.1)+
geom_histogram(bins=100)+
theme_classic()+
theme(plot.title = element_text(size = 11),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())+
scale_x_continuous(expand = c(0,0),
limits = c(0, 100))+
scale_y_continuous(expand= c(0,0),
breaks = c(15, 30, 45))+
xlab(element_blank())+
ylab(element_blank())+
geom_vline(xintercept=20.6*1.05, color = "red")+
geom_vline(xintercept = 12*1.05, linetype = "dashed", color = "red")+
ggtitle("Thurston County")+
annotate(geom = "text", y = 30, x = 80, label = "n = 297", size=3.5) +
annotate(geom = "text", y = 20, x = 80, label = "skew = 1.02", size=3.5)
#Plot Hist
#Multiplied by 1.05 to normalize to 100
P5 <- ThurstonF%>%
ggplot(aes(x=TotalScore*1.05))+
geom_rect(aes(xmin = 5*1.05, xmax = 34*1.05, ymin = 0, ymax = 50), fill = "pink1",alpha = 0.1)+
geom_histogram(bins=100)+
theme_classic()+
theme(plot.title = element_text(size = 11),
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank())+
scale_x_continuous(expand = c(0,0),
limits = c(0, 100))+
scale_y_continuous(expand= c(0,0),
breaks = c(15, 30, 45))+
xlab(element_blank())+
ylab(element_blank())+
geom_vline(xintercept=20.6*1.05, color = "red")+
geom_vline(xintercept = 12*1.05, linetype = "dashed", color = "red")+
ggtitle("Thurston")+
annotate(geom = "text", y = 30, x = 80, label = "n = 297", size=3.5) +
annotate(geom = "text", y = 20, x = 80, label = "skew = 1.02", size=3.5)
histogram <- WDFW/P4/P2/P5/P1/P3
ggsave("histogram.jpg", path = "output/DistributionFigures", plot=histogram, device="jpg")
ggsave("histogram.jpg", path = "output/DistributionFigures", plot=histogram, device="jpg")
histogram
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg")
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 7, width = 3)
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 5, width = 3)
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 7, width = 4)
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 7.5, width = 4)
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 8, width = 4)
ggsave("histogram.jpg", path = here("output/DistributionFigures"), plot=histogram, device="jpg",
height = 8.5, width = 4)
CoastChinook<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Not listed",Run = "WA Coast", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetChinook <- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Listed", Run = "Puget Sound", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Coho
OPCoho<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Not listed", Run = "Olympic Peninsula/SW WA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Fake", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
QuinaltSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Not listed", Run = "Quinalt/Baker River", Scenario = "Real",  M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Bull
Bull_Dolly <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Rainbow
Rainbow <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Chum
HoodChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Listed", Run = "Hood River", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Not listed", Run = "Pacific Coast/Puget Sound", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Pink
OddPink <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Not listed", Run = "Odd/Even", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Steelhead
OPSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Not listed", Run = "Olympic Penninsula", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Cutthroat
Cutthroat <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook)
#Create dummy dataframes for each species and each run type
#I got the data for the ESA listing from salmonscape
#Chinook
CoastChinook<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Not listed",Run = "WA Coast", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetChinook <- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Listed", Run = "Puget Sound", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Coho
OPCoho<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Not listed", Run = "Olympic Peninsula/SW WA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetCoho <- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Species of concern", Run = "Puget Sound", Scenario = "Real", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Fake", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
QuinaltSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Not listed", Run = "Quinalt/Baker River", Scenario = "Real",  M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Bull
Bull_Dolly <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Rainbow
Rainbow <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Chum
HoodChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Listed", Run = "Hood River", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Not listed", Run = "Pacific Coast/Puget Sound", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Pink
OddPink <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Not listed", Run = "Odd/Even", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Steelhead
OPSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Not listed", Run = "Olympic Penninsula", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Listed", Run = "Puget/SW WA", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Cutthroat
Cutthroat <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook)
SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")->
SpeciesPlot
SpeciesPlot
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "NotReal", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook)
SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")->
SpeciesPlot
SpeciesPlot
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook)
SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")->
SpeciesPlot
SpeciesPlot
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook, ChinookS, CohoS, SockeyeS, BullDollyS3, BullDollyS2, RainbowS2, RainbowS3, CoastChumS, OddPinkS3, OddPinkS2, PugetSteelheadS, CutthroatS3, CutthroatS2)
#Create dummy dataframes for each species and each run type
#I got the data for the ESA listing from salmonscape
#Chinook
CoastChinook<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Not listed",Run = "WA Coast", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetChinook <- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Listed", Run = "Puget Sound", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
ChinookS<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Species of concern",Run = "WA Coast", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Coho
OPCoho<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Not listed", Run = "Olympic Peninsula/SW WA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetCoho <- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Species of concern", Run = "Puget Sound", Scenario = "Real", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CohoS<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Listed", Run = "Olympic Peninsula/SW WA", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
QuinaltSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Not listed", Run = "Quinalt/Baker River", Scenario = "Real",  M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
SockeyeS <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Species of Concern", Run = "Quinalt/Baker River", Scenario = "Scenario",  M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Bull
Bull_Dolly <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
BullDollyS2 <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=1, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
BullDollyS3 <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=1, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Rainbow
Rainbow <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
RainbowS2 <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=1, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
RainbowS3 <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=1, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Chum
HoodChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Listed", Run = "Hood River", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Not listed", Run = "Pacific Coast/Puget Sound", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChumS <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Species of concern", Run = "Pacific Coast/Puget Sound", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Pink
OddPink <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Not listed", Run = "Odd/Even", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
OddPinkS2 <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Species of concern", Run = "Odd/Even", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
OddPinkS3 <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Listed", Run = "Odd/Even", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Steelhead
OPSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Not listed", Run = "Olympic Penninsula", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Listed", Run = "Puget/SW WA", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetSteelheadS <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Species of concern", Run = "Puget/SW WA", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Cutthroat
Cutthroat <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CutthroatS2 <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CutthroatS3 <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook, ChinookS, CohoS, SockeyeS, BullDollyS3, BullDollyS2, RainbowS2, RainbowS3, CoastChumS, OddPinkS3, OddPinkS2, PugetSteelheadS, CutthroatS3, CutthroatS2)
#Create dummy dataframes for each species and each run type
#I got the data for the ESA listing from salmonscape
#Chinook
CoastChinook<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Not listed",Run = "WA Coast", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetChinook <- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Listed", Run = "Puget Sound", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
ChinookS<- data.frame(B=1, P=0.016, H=1:5000, Species = "Chinook Salmon", ESA = "Species of concern",Run = "WA Coast", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Coho
OPCoho<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Not listed", Run = "Olympic Peninsula/SW WA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetCoho <- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Species of concern", Run = "Puget Sound", Scenario = "Real", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CohoS<- data.frame(B=1, P=0.05, H=1:5000, Species = "Coho Salmon", ESA = "Listed", Run = "Olympic Peninsula/SW WA", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Sockeye
PlesantSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Listed", Run = "Lake Plesant",  Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
QuinaltSockeye <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Not listed", Run = "Quinalt/Baker River", Scenario = "Real",  M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
SockeyeS <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Species of Concern", Run = "Quinalt/Baker River", Scenario = "Scenario",  M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Bull
Bull_Dolly <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
BullDollyS2 <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=1, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
BullDollyS3 <- data.frame(B=1, P=0.0007, H=1:5000, Species = "Bull Trout/Dolly Varden", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=1, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Rainbow
Rainbow <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=1, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
RainbowS2 <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=1, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
RainbowS3 <- data.frame(B=1, P=0.04, H=1:5000, Species = "Rainbow Trout", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=1, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Chum
HoodChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Listed", Run = "Hood River", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChum <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Not listed", Run = "Pacific Coast/Puget Sound", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CoastChumS <- data.frame(B=1, P=1.25, H=1:5000, Species = "Chum Salmon", ESA = "Species of concern", Run = "Pacific Coast/Puget Sound", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Pink
OddPink <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Not listed", Run = "Odd/Even", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
OddPinkS2 <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Species of concern", Run = "Odd/Even", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
OddPinkS3 <- data.frame(B=1, P=1.25, H=1:5000, Species = "Pink Salmon", ESA = "Listed", Run = "Odd/Even", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Steelhead
OPSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Not listed", Run = "Olympic Penninsula", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetSteelhead <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Listed", Run = "Puget/SW WA", Scenario = "Real", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
PugetSteelheadS <- data.frame(B=1, P=0.0021, H=1:5000, Species = "Steelhead", ESA = "Species of concern", Run = "Puget/SW WA", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Cutthroat
Cutthroat <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Not listed", Run = "NA", Scenario = "Real", M=2, D=1, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CutthroatS2 <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Species of concern", Run = "NA", Scenario = "Scenario", M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
CutthroatS3 <- data.frame(B=1, P=0.037, H=1:5000, Species = "Cutthroat Trout", ESA = "Listed", Run = "NA", Scenario = "Scenario", M=2, D=3, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook, ChinookS, CohoS, SockeyeS, BullDollyS3, BullDollyS2, RainbowS2, RainbowS3, CoastChumS, OddPinkS3, OddPinkS2, PugetSteelheadS, CutthroatS3, CutthroatS2)
SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")->
SpeciesPlot
SpeciesPlot
SockeyeS <- data.frame(B=1, P=3, H=1:5000, Species = "Sockeye Salmon", ESA = "Species of concern", Run = "Quinalt/Baker River", Scenario = "Scenario",  M=2, D=2, C=3) %>%
mutate(PI = (B*P*H*M*D*C)^(1/4))
#Join all the dataframes so that they can be plotted together
SpeciesJoin = rbind(Cutthroat, PugetSteelhead, OPSteelhead, OddPink,
CoastChum, HoodChum, Rainbow, Bull_Dolly, QuinaltSockeye, PlesantSockeye,
PugetCoho, OPCoho, CoastChinook, PugetChinook, ChinookS, CohoS, SockeyeS, BullDollyS3, BullDollyS2, RainbowS2, RainbowS3, CoastChumS, OddPinkS3, OddPinkS2, PugetSteelheadS, CutthroatS3, CutthroatS2)
SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")->
SpeciesPlot
SpeciesPlot
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted")) +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"),
values=c("#e41a1c", "#377eb8", "#4daf4a"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted")) +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"))+
scale_color_discrete(limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted")) +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"),
limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted")) +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"),
limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted"),
legend.position = "none") +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot <- SpeciesJoin %>%
mutate(Species = fct_reorder(Species, desc(P))) %>%
ggplot(aes(x=H, y=PI, color=ESA))+
geom_line(size=.8, aes(linetype = Scenario))+
scale_color_manual(values=c("#e41a1c", "#377eb8", "#4daf4a"),
limits = c("Listed", "Species of concern", "Not listed"))+
facet_wrap(~Species)+
theme_classic()+
theme(strip.background=element_blank())+
scale_linetype_manual(values = c("solid", "dotted"),
guide = "none") +
scale_x_continuous(expand = c(0,0),
breaks = c(1000, 3000, 5000))+
scale_y_continuous(expand= c(0,0))+
labs(x = "Habitat Quanity (m)", y = "PI Score")
SpeciesPlot
#Save Plot
ggsave(here("output/WDFW Figures","SpeciesLine.pdf"), plot = SpeciesPlot, device = "pdf")
